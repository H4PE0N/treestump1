
SOURCE_FOLDER := ../Source-Files-Folder
OBJECT_FOLDER := ../Object-Files-Folder
BINARY_FOLDER := ../Binary-Files-Folder

ENGINE_FOLDER := $(SOURCE_FOLDER)/Chess-Engine-Folder
ENGLOG_FOLDER := $(SOURCE_FOLDER)/Engine-Logic-Folder
CONSOLE_FOLDER := $(SOURCE_FOLDER)/Game-Console-Folder
MASTER_FOLDER := $(SOURCE_FOLDER)/Game-Master-Folder
SCREEN_FOLDER := $(SOURCE_FOLDER)/Game-Screen-Folder
SOCKET_FOLDER := $(SOURCE_FOLDER)/Game-Socket-Folder

ENGLOG_SOURCE := $(ENGLOG_FOLDER)/Source-Files-Folder
ENGLOG_HEADER := $(ENGLOG_FOLDER)/Header-Files-Folder

ENGINE_SOURCE := $(ENGINE_FOLDER)/Source-Files-Folder
ENGINE_HEADER := $(ENGINE_FOLDER)/Header-Files-Folder

CONSOLE_SOURCE := $(CONSOLE_FOLDER)/Source-Files-Folder
CONSOLE_HEADER := $(CONSOLE_FOLDER)/Header-Files-Folder

SCREEN_SOURCE := $(SCREEN_FOLDER)/Source-Files-Folder
SCREEN_HEADER := $(SCREEN_FOLDER)/Header-Files-Folder

SOCKET_HEADER := $(SOCKET_FOLDER)/Header-Files-Folder
SOCKET_SOURCE := $(SOCKET_FOLDER)/Source-Files-Folder


ENGLOG_SOURCES := $(wildcard $(ENGLOG_SOURCE)/*.c)
ENGLOG_HEADERS := $(wildcard $(ENGLOG_HEADER)/*.h)
ENGLOG_OBJECTS := $(patsubst $(ENGLOG_SOURCE)/%.c, $(OBJECT_FOLDER)/%.o, $(ENGLOG_SOURCES))

ENGINE_SOURCES := $(wildcard $(ENGINE_SOURCE)/*.c)
ENGINE_HEADERS := $(wildcard $(ENGINE_HEADER)/*.h)
ENGINE_OBJECTS := $(patsubst $(ENGINE_SOURCE)/%.c, $(OBJECT_FOLDER)/%.o, $(ENGINE_SOURCES))

CONSOLE_SOURCES := $(wildcard $(CONSOLE_SOURCE)/*.c)
CONSOLE_HEADERS := $(wildcard $(CONSOLE_HEADER)/*.h)
CONSOLE_OBJECTS := $(patsubst $(CONSOLE_SOURCE)/%.c, $(OBJECT_FOLDER)/%.o, $(CONSOLE_SOURCES))

SCREEN_SOURCES := $(wildcard $(SCREEN_SOURCE)/*.c)
SCREEN_HEADERS := $(wildcard $(SCREEN_HEADER)/*.h)
SCREEN_OBJECTS := $(patsubst $(SCREEN_SOURCE)/%.c, $(OBJECT_FOLDER)/%.o, $(SCREEN_SOURCES))

SOCKET_SOURCES := $(wildcard $(SOCKET_SOURCE)/*.c)
SOCKET_HEADERS := $(wildcard $(SOCKET_HEADER)/*.h)
SOCKET_OBJECTS := $(patsubst $(SOCKET_SOURCE)/%.c, $(OBJECT_FOLDER)/%.o, $(SOCKET_SOURCES))


GROUP1_SOURCES := $(ENGLOG_SOURCES) $(ENGINE_SOURCES) $(CONSOLE_SOURCES)
GROUP1_HEADERS := $(ENGLOG_HEADERS) $(ENGINE_HEADERS) $(CONSOLE_HEADERS)
GROUP1_OBJECTS := $(ENGLOG_OBJECTS) $(ENGINE_OBJECTS) $(CONSOLE_OBJECTS)

GROUP2_SOURCES := $(ENGLOG_SOURCES) $(ENGINE_SOURCES) $(CONSOLE_SOURCES) $(SOCKET_SOURCES)
GROUP2_HEADERS := $(ENGLOG_HEADERS) $(ENGINE_HEADERS) $(CONSOLE_HEADERS) $(SOCKET_HEADERS)
GROUP2_OBJECTS := $(ENGLOG_OBJECTS) $(ENGINE_OBJECTS) $(CONSOLE_OBJECTS) $(SOCKET_OBJECTS)

GROUP3_SOURCES := $(ENGLOG_SOURCES) $(ENGINE_SOURCES) $(SCREEN_SOURCES)
GROUP3_HEADERS := $(ENGLOG_HEADERS) $(ENGINE_HEADERS) $(SCREEN_HEADERS)
GROUP3_OBJECTS := $(ENGLOG_OBJECTS) $(ENGINE_OBJECTS) $(SCREEN_OBJECTS)

GROUP4_SOURCES := $(ENGLOG_SOURCES) $(ENGINE_SOURCES) $(SCREEN_SOURCES) $(SOCKET_SOURCES)
GROUP4_HEADERS := $(ENGLOG_HEADERS) $(ENGINE_HEADERS) $(SCREEN_HEADERS) $(SOCKET_HEADERS)
GROUP4_OBJECTS := $(ENGLOG_OBJECTS) $(ENGINE_OBJECTS) $(SCREEN_OBJECTS) $(SOCKET_OBJECTS)


OBJECT_FILES := $(ENGLOG_OBJECTS) $(ENGINE_OBJECTS) $(CONSOLE_OBJECTS) $(SCREEN_OBJECTS) $(SOCKET_OBJECTS)
.PRECIOUS: $(OBJECT_FILES)


COMPILE_PROGRAM := gcc
COMPILE_FLAGS := -Wall -Werror -O0 -lm


SDL_LIB_FLAGS := -lSDL2main -lSDL2 -lSDL2_image
SDL_DIR_FLAGS := -ISDL2/include -LSDL2/lib

WIN_SDL_FLAGS := $(SDL_DIR_FLAGS) -lmingw32 $(SDL_LIB_FLAGS)
WIN_SOC_FLAGS := -lws2_32

LIN_SDL_FLAGS := `sdl2-config --libs --cflags` $(SDL_LIB_FLAGS)
LIN_SOC_FLAGS :=

SOCKET_FLAGS := $(LIN_SOC_FLAGS)
SCREEN_FLAGS := $(LIN_SDL_FLAGS)


GROUP1_FLAGS := $(COMPILE_FLAGS)
GROUP2_FLAGS := $(COMPILE_FLAGS) $(SOCKET_FLAGS)
GROUP3_FLAGS := $(COMPILE_FLAGS) $(SCREEN_FLAGS)
GROUP4_FLAGS := $(COMPILE_FLAGS) $(SCREEN_FLAGS) $(SOCKET_FLAGS)


GROUP1_FILES := engine-console single-console multi-console debugging
GROUP2_FILES := engine-socket client-console server-console
GROUP3_FILES := single-screen multi-screen
GROUP4_FILES := client-screen server-screen

EXE_FILES := $(GROUP1_FILES) $(GROUP2_FILES) $(GROUP3_FILES) $(GROUP4_FILES)


$(GROUP1_FILES): %: $(OBJECT_FOLDER)/%.o $(GROUP1_OBJECTS) $(MASTER_FOLDER)/%.c $(GROUP1_SOURCES) $(GROUP1_HEADERS)
	$(COMPILE_PROGRAM) $(GROUP1_OBJECTS) $(OBJECT_FOLDER)/$@.o $(GROUP1_FLAGS) -o $@

$(GROUP2_FILES): %: $(OBJECT_FOLDER)/%.o $(GROUP2_OBJECTS) $(MASTER_FOLDER)/%.c $(GROUP2_SOURCES) $(GROUP2_HEADERS)
	$(COMPILE_PROGRAM) $(GROUP2_OBJECTS) $(OBJECT_FOLDER)/$@.o $(GROUP2_FLAGS) -o $@

$(GROUP3_FILES): %: $(OBJECT_FOLDER)/%.o $(GROUP3_OBJECTS) $(MASTER_FOLDER)/%.c $(GROUP3_SOURCES) $(GROUP3_HEADERS)
	$(COMPILE_PROGRAM) $(GROUP3_OBJECTS) $(OBJECT_FOLDER)/$@.o $(GROUP3_FLAGS) -o $@

$(GROUP4_FILES): %: $(OBJECT_FOLDER)/%.o $(GROUP4_OBJECTS) $(MASTER_FOLDER)/%.c $(GROUP4_SOURCES) $(GROUP4_HEADERS)
	$(COMPILE_PROGRAM) $(GROUP4_OBJECTS) $(OBJECT_FOLDER)/$@.o $(GROUP4_FLAGS) -o $@


$(OBJECT_FOLDER)/%.o: $(MASTER_FOLDER)/%.c
	$(COMPILE_PROGRAM) $< -c $(COMPILE_FLAGS) -o $@

$(OBJECT_FOLDER)/%.o: $(ENGLOG_SOURCE)/%.c $(ENGLOG_HEADER)/%.h
	$(COMPILE_PROGRAM) $< -c $(COMPILE_FLAGS) -o $@

$(OBJECT_FOLDER)/%.o: $(ENGINE_SOURCE)/%.c $(ENGINE_HEADER)/%.h
	$(COMPILE_PROGRAM) $< -c $(COMPILE_FLAGS) -o $@

$(OBJECT_FOLDER)/%.o: $(SCREEN_SOURCE)/%.c $(SCREEN_HEADER)/%.h
	$(COMPILE_PROGRAM) $< -c $(COMPILE_FLAGS) -o $@

$(OBJECT_FOLDER)/%.o: $(SOCKET_SOURCE)/%.c $(SOCKET_HEADER)/%.h
	$(COMPILE_PROGRAM) $< -c $(COMPILE_FLAGS) -o $@

$(OBJECT_FOLDER)/%.o: $(CONSOLE_SOURCE)/%.c $(CONSOLE_HEADER)/%.h
	$(COMPILE_PROGRAM) $< -c $(COMPILE_FLAGS) -o $@


FILES_TARGET := files
CLEAN_TARGET := clean

REMOVE_CMD := rm
REMOVE_FLAGS :=

$(FILES_TARGET):
	@echo $(foreach FILE, $(EXE_FILES), $(FILE))

$(CLEAN_TARGET):
	$(REMOVE_CMD) $(REMOVE_FLAGS) $(OBJECT_FOLDER)/*.o $(EXE_FILES)
